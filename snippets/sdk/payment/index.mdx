---
title: "Card Operation Process"
---

The payment journey is a real-time interaction between your mobile app, the CoinBridge SDK, and the back-end systems. This process enables a "Tap & Go" experience using the NFC/EMV protocol at any point of sale (POS).

---

## Payment Screen Requirements

To ensure a smooth user experience, your main payment screen must include the following elements:

* **Available Balance**: Display the user's balance in the correct currency.
* **Virtual Card Image**: A visual representation of the card following the official style guide.
* **Spending Policies**: Clear notes on any payment restrictions or guidelines.
* **Call to Action (CTA)**: A dedicated "Pay" button.
    * **iOS**: Use the official Apple "Pay with Apple Pay" button.
    * **Android**: Use a prominent CTA button that triggers the biometric prompt.

---

## The Payment Flow

### Step 1: Prepare to Pay
When the user taps the payment button, the app must notify the SDK to get the NFC component ready.
* **Action**: Call the `prepareToPay` method.
* **Android Note**: You must trigger the system Biometric Prompt *before* calling this method to request fingerprint or face recognition.

### Step 2: NFC Activation
Once the SDK returns a `ReadyToPay` signal, the device is prepared for the tap.
* **iOS**: The user is automatically redirected to the Apple Wallet with the virtual card selected.
* **Android**: The device NFC tool opens to allow communication with the EMV terminal.

### Step 3: The Tap
The user holds their device near the merchant's POS terminal.
* **Technical Detail**: The terminal transmits data via NFC. A successful tap signal only means data was sent; it does not mean the payment is approved yet.

### Step 4: Transaction Resolution
The merchant terminal communicates with the card network (Visa/Mastercard) to authorize the request.
* **Back-End Validation**: The CoinBridge Back-End Connector receives the request and checks the user's real-time balance and spending policies.
* **Decision**: The system determines whether to approve or decline based on fraud, risk, and funds.

---

## Handling Results

The final decision is sent back to your platform via the Back-End Connector. You must then notify the user of the outcome.

* **Approved**: Show a success message along with the transaction amount and merchant name.
* **Declined**: Show a decline message along with the specific reason (e.g., "Insufficient Funds").

> ### ðŸ’¡ Technical Tip
> If a user cancels the payment or the app decides to stop the process, you must call the `stopPayment` method (on Android) or restart the flow as a new action to reset the SDK state.

# Article 3: Transaction Readiness (Payment Flow)

Once the digital card is issued and provisioned, the user enters the **Transaction Readiness** phase. [cite_start]This ensures the SDK is synchronized with the latest backend information before every payment attempt[cite: 460, 876, 2177].

---

## 1. Status Verification

[cite_start]To enable the payment interface, the application must verify that both the virtual card and the digital token are in a "Ready" state[cite: 1463, 2857]. 

### Required States for Payment
[cite_start]Every time the application launches or returns to the foreground, you must call `initialize` and check the `CBPaymentStatus` object[cite: 460, 469, 1103, 2177]:

* [cite_start]**Card Status**: Must be `ACTIVE`[cite: 1032, 1835, 2305, 2984]. [cite_start]If the status is `NOT_ACTIVE` (suspended), the payment button must be disabled, and the user should be directed to support[cite: 465, 1038, 2311].
* [cite_start]**Token Status**: Must be `ACTIVE`[cite: 1030, 1847, 2369, 2997]. [cite_start]This confirms the card is properly provisioned to the device's secure element[cite: 1419, 2369, 2997].

---

## 2. The "Happy Path" (Setup to Tap)

The following flow illustrates the standard journey from opening the app to a successful terminal tap.

### Step 1: Initialization & Status Check
[cite_start]The app calls `initialize` to retrieve the latest `CBCardStatus` and `TokenStatus`[cite: 469, 1019, 2177, 2225]. [cite_start]The UI updates to show the digital card art, the last four digits, and the available balance[cite: 425, 427, 447, 1071, 1072, 2392, 2393].

### Step 2: Intent to Pay
[cite_start]The user clicks the **Pay** (Android) or **Pay with Apple Pay** (iOS) button[cite: 1085, 2395, 2403, 2863].

### Step 3: Biometric Authentication
[cite_start]The application must invoke the OS **Biometric Prompt** (Fingerprint, Face ID, or Passcode)[cite: 847, 1081, 1082, 1478, 2158]. [cite_start]This is a mandatory security step to authorize the use of the digital token[cite: 1082, 1478, 2158, 2161].

### Step 4: Prepare to Pay
[cite_start]Upon successful biometric auth, the app calls `prepareToPay`[cite: 1085, 1470, 2403, 2862, 2916]. [cite_start]This notifies the backend that a transaction is imminent and activates the device's NFC antenna for a limited window (default is 30 seconds)[cite: 1467, 1472, 1703, 2862].

### Step 5: Tapping the Terminal
[cite_start]The app displays a **"Hold Near Reader"** indication[cite: 1471, 1583, 2405, 2866]. [cite_start]The user taps their device against the EMV terminal, completing the NFC exchange[cite: 804, 1086, 1110, 1583, 2098, 2404].

> [cite_start]**Note:** A "Tap Completed" signal only means data was transmitted to the terminal; it does not guarantee the transaction is approved[cite: 1110, 2408, 2409]. [cite_start]The final result (Approved/Declined) is delivered via the Backend Connector[cite: 1111, 2419, 2423, 2425].


