---
title: "How the CoinBridge Payment Process Works" 
---
CoinBridge technology enables real-world purchases using digital assets by leveraging the NFC/EMV protocol at any point of sale worldwide. This guide outlines the end-to-end integration of the mobile SDK and webhooks.
### The Integration Process
The integration process consists of four primary phases:
1.  **Authenticate & Verify:** Establish user identity and regulatory eligibility.
2.  **Initialize:** Check the user's current card and wallet status.
3.  **Provision:** Create a virtual card and add it to the device's secure wallet.
4.  **Transact:** Execute payments and sync data via webhooks.

---

### Step 1: Install the SDK
Add the CoinBridge library to your mobile project to enable NFC capabilities.

* **Android:** Update your `build.gradle` file to include the dependency (Minimum API Level 26).
* **iOS:** Add the package via **Swift Package Manager (SPM)** (Minimum iOS 13.4).

---

### Step 2: Authenticate the User 
Secure the connection between your app and the CoinBridge platform.

1.  Create a JSON Web Token on your backend using the **RS256** algorithm.
2.  Use a consistent Unique ID across your mobile app, backend webhooks, and the CoinBridge platform.
3.  Verify the user meets regulatory criteria (e.g., country of residence) before proceeding.
4.  Ensure RSA private keys are stored exclusively on your server; never bundle them in the mobile app.

---

### Step 3: Initialize the SDK
Determine the user's current onboarding state to provide the correct UI flow.

1.  Call the `init` method after the user is authenticated.
2.  Use the returned `hasCard` (Boolean) and `CBPaymentStatus` (Object) to route the user:
    * **If `hasCard` is false:** Direct the user to **Step 4 (Create Card)**.
    * **If `hasCard` is true but no wallet token exists:** Direct the user to **Step 5 (Push to Wallet)**.
    * **If fully setup:** Allow the user to proceed to payment.

---

### Step 4: Create a Card
Issue a virtual card to act as the bridge between digital assets and the payment terminal.

1.  Call the `IssueCard` method to generate the user's virtual credentials.
2.  Present a form to collect required information (e.g., SSN or National ID) and obtain agreement to Terms & Conditions.
3.  Ensure your backend responds to the CoinBridge issuance webhook to validate user funds and risk policies in real-time.
---

### Step 5: Push to Wallet
Enable "Tap & Go" by adding the virtual card to the device's native secure element.

1.  Enable **Entitlements** (iOS) or **Play Services** (Android) in your project settings.
2.  Trigger Provisioning:
    * **Android:** Call `provisionCard` to add the token to **Google Wallet**.
    * **iOS:** Call `addToApplePay` to add the card to **Apple Wallet**.
3.  Verify that `CBPaymentStatus` now reflects a valid wallet token.

---

### Step 6: Execute Payments (iOS Implementation)
On iOS, a manual trigger is required to launch the payment interface.

1.  Display "Pay Now" Button (Only after the card is successfully provisioned.)
2.  Trigger NFC/EMV protocol when the user taps the button.
3.  Ensure your loyalty platform is ready to respond to real-time requests to verify balances and approve spending rules when the device contacts a POS terminal.

---

### Step 7: Connect the Webhooks
Keep your platform synchronized with real-world spending.

1.  Connect webhooks to the **Transaction Report Endpoint**.
2.  Deduct the appropriate digital assets from the user's account immediately upon receiving a successful transaction report.
3.  Populate the user's in-app transaction history with the data provided by the webhook.





# How the CoinBridge Payment Process Works

While CoinBridge provides a sophisticated bridge between digital assets and traditional retail, the basic payment process always follows the same sequence. This guide provides a step-by-step breakdown of the process and key elements involved, clarifying how payments flow when utilizing the CoinBridge SDKs and webhooks.



### The CoinBridge payment process
The payment process consists of four steps:
* Authenticate and initialize
* Issue a virtual card
* Provision to a digital wallet
* Create the payment

A successful payment leads to a completed transaction where digital assets are converted into usable currency at any shop worldwide based on the user's available funds.

The steps below explain each part of the process in detail.

---

### Step 1: Authenticate and initialize
Every payment in CoinBridge links to a verified user. The system uses a JSON Web Token (JWT) generated by your backend to establish a secure session. This ensures that only authorized users can access their digital asset balances.

When you authenticate the user and call the `init` method, CoinBridge generates a unique identifier for use in later steps. This initialization step also determines the user's current stateâ€”whether they already have a card or if they need to be routed to the issuance flow.

> **Note**
> You will need the user's identification information for each subsequent step.

---

### Step 2: Issue a virtual card
To process a payment, you must first create a virtual card. This card connects the user to the global payment network and stores the rules for how their digital assets should be spent.

When you issue a card, CoinBridge synchronizes with your platform via webhooks. This allows you to validate the user's funds and apply risk policies before the card is activated. Depending on local regulations, you may collect identification details such as an SSN or National ID to improve the user's onboarding experience.

---

### Step 3: Provision to a digital wallet
A digital wallet token enhances payment security by protecting sensitive card information. This process, known as provisioning, enables the "Tap & Go" experience by placing the virtual card into the device's secure hardware.

To provision a card, the SDK facilitates the connection between:
* The user's identification
* The issued virtual card
* The selected mobile wallet (Apple Pay or Google Pay)



> **Info**
> A wallet token is a secure, device-specific version of the card that prevents unauthorized reuse. It enhances security by ensuring the actual card details are never stored on your servers or exposed during transactions.

---

### Step 4: Create the payment
A payment represents a user's transaction at a Point-of-Sale (POS) terminal, consolidating all necessary order and funding details.

To process a payment, the user interacts with a physical terminal using NFC technology. The transaction must occur through a provisioned digital wallet and include:
* A connected user
* A valid wallet token for security
* A real-time balance authorization from your platform

The CoinBridge protocol organizes these transaction details, ensuring a clear and structured payment flow. This setup simplifies tracking and reconciliation for your backend.

### Enhance the user's experience
After creating the payment, CoinBridge will keep you informed about updates through webhooks. This allows you to update the user's balance and transaction history immediately. Additionally, you can integrate spending rules and risk checks into the authorization flow to prevent fraud and ensure a smooth transaction experience.

