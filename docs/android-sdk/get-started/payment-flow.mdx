---
title: "Payment Flow"
---

This guide provides a simple overview of how a user moves through the CoinBridge system. It explains how the app on the phone (the SDK) and the server (the Backend) work together so that everyone from Developers to Product Managers can see exactly how a payment happens.

## 1. Installation Flow (Onboarding)

The Installation journey is a one-time setup. Think of it as "getting the wallet ready." This phase makes sure the user is who they say they are and gives them a digital card they can use to pay.

![Pre-payment process diagram showing initial transaction setup with payment method selection and customer verification steps before processing payment](/images/pre-payment.png)
The steps in this process are as follows:

1. **Authenticate**: The app connects the user’s account to the CoinBridge system. This creates a secure link so the system knows which digital assets belong to which person.
2. **Initialize**: Behind the scenes, the app and the server do a quick "handshake" to make sure the user’s wallet is ready. It double-checks that everything is synced up before the user tries to buy anything.
3. **Create Card**: If the user doesn’t have a digital card yet, the app starts the setup. Depending on local rules, the user might need to enter some ID info (like an SSN) and agree to the terms.
4. **Create Card Token**: Instead of using a real card number that could be stolen, the system creates a "Token." This is a digital stand-in for the card. It’s what actually talks to the store’s payment terminal, keeping the real card data safe and hidden.
5. **Add Card to Wallet**: This is the final step, often called **Provisioning**.
    * **Android**: The digital card is saved directly inside the app’s secure storage.
    * **iOS**: The card is added to the Apple Wallet so it can be used with an iPhone or Apple Watch.

## 2. Payment Flow (Transaction)

Once the card is set up, users can pay by tapping their phone on a store's reader using NFC technology.

![Payment processing flow diagram showing the complete payment transaction sequence with status indicators and confirmation steps](/images/payment.png)
The steps in this process are as follows:

## Authorization Scenarios
CoinBridge supports two configurations for authorizing a transaction. Your specific setup is determined during onboarding.

### CoinBridge Approves the Transaction
In this configuration, CoinBridge evaluates the transaction against your user's data in real-time.
* **Fetch Balance**: CoinBridge calls your `/user/{userId}/balance` endpoint to retrieve the user's current funds.
* **Evaluate Spending Policy**: CoinBridge checks rules such as restricted countries, Merchant IDs (MID), or Merchant Category Codes (MCC).
* **Corporate Balance Check**: CoinBridge verifies that your application account has sufficient funds to cover the purchase.

### Customer Approves the Transaction
This synchronous flow allows your backend to make the final decision.
* **Receive Details**: CoinBridge forwards full transaction metadata to your `/authorize` endpoint.
* **Respond with Decision**: Your backend must return an `approved` or `declined` status within the card scheme's strict time limits.
* **Provide Decline Reason**: If you decline, you must provide a reason code (e.g., `INSUFFICIENT_FUNDS`) to inform the user.

See more about our process:

<CardGroup cols={3}>
  <Card title="Integration Process" icon="gears" href="/docs/get-started/integration-process">
  Learn the architecture and integration model behind CoinBridge.
  </Card>

  <Card title="SDK Guides" icon="mobile-screen" href="/docs/sdk/index">
    Integrate our SDKs for Android and iOS.
  </Card>

  <Card title="Webhook Guides" icon="bridge-water" href="/docs/webhooks/index">
    Stay in sync with real-time status updates by connecting your backend to our event system.
  </Card>
</CardGroup>

