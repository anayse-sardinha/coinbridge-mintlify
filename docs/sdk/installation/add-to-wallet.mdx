---
title: "Add Card to Wallet (Provisioning)"
---

Provisioning is the mandatory final step of the onboarding journey. It moves your user's virtual card from the CoinBridge backend into a native device wallet to enable contactless Tap & Go payments.

<Tabs>
  <Tab title="Android Implementation: Google Wallet ">
  On Android, the SDK handles card provisioning to the internal wallet. Your primary responsibility is ensuring the device's NFC and security settings are correctly configured for payments.

   ### Prerequisites
    * **OS Version**: Android 8.0 Oreo (API level 26) or higher.
    * **Hardware**: The device must be NFC-equipped and not rooted.
    * **Security**: Users must have a passcode, pattern, or fingerprint lock enabled for payment features.

    ### Provisioning & NFC Configuration
    <Steps>
    1. **Provisioning Method**: Call the `provisionCard` method to push the virtual card token into the SDK wallet.
    2. **Verify Settings**: Before allowing a payment attempt, your app should call these `CBHelper` methods to ensure hardware readiness:
    * `isNFCEnabled`: Confirms NFC is turned on.
    * `isPayWithCurrentlyOpenAppEnabled`: Verifies the "Pay with open app" flag is enabled.
    3. **System Redirects**: If these settings are disabled, use `launchNfcSettings` or `launchContactlessPaymentsSettings` to guide the user to the correct Android system menu.
    </Steps>
    ### UI & Logic Guidelines
    * **Check Status**: Call the `init` method in the `onCreate()` of your payment activity to check current readiness.
    * **Ready to Pay**: Only display the **"Pay"** button once the wallet status returns as `ACTIVE`.
  </Tab>

  <Tab title="iOS Implementation: Apple Wallet">
   On iOS, users must add the virtual card to the iPhone or Apple Watch. This process uses Apple's native provisioning forms and does not require two-factor authentication.

    ### Prerequisites
    * **OS/Hardware**: iOS 13.4+ and iPhone 7 or newer.
    * **Security**: Users must have Face ID, Touch ID, or a device passcode configured.
    * **Card State**: The card must be `active` and the `tokenStatus` for the device must be `none`.

    ### Provisioning Flow
    <Steps>
    1. **Check Compatibility**: Use `cardCanAddToApplePay` to verify if the device or paired watch can receive the card.
    2. **Initiate Request**: Call the `addToApplePay` method to open the native Apple Wallet overlay.
    3. **Confirm Activation**: Wait for the `onPaymentMethodStatusChange` notification via the `CBNotification` service to confirm the `tokenStatus` has transitioned to `active`.
    </Steps>
    ### UI & Logic Guidelines
    * **Button Visibility**: You must keep the **"Add to Apple Wallet"** button visible on the main screen until the user has provisioned all paired devices (e.g., both iPhone and Apple Watch).
    * **Apple Watch**: If a user has a linked watch, you must provide a dedicated hub or screen to allow watch-specific provisioning.
    * **Existing Users**: If an existing user logs in on a new device, do not re-issue a card; initialization will return `hasCard = true`, and you should proceed directly to this provisioning step.
</Tab>
</Tabs>

## Mandatory Communication Requirements

To comply with financial regulations and Apple's terms, you must establish an automated process to send notifications via a "tenured channel" (Email or SMS).

| Scenario | Trigger | Mandatory Requirement |
| :--- | :--- | :--- |
| **Provisioning Success** | Successful activation. | Send confirmation within 1 hour of activation. |
| **Abandoned Flow** | User started but did not finish. | Notify the user within 24 hours explaining how to complete activation. |
| **Inactive Users** | Provisioned but unused. | If no transaction occurs within 7 days, send an email highlighting Apple Pay benefits. |
| **User Incentives** | (iOS specific) Incomplete flow. | A minimum **20 ILS** incentive must be offered if provisioning is not completed within 7 days or first use within 14 days. |


